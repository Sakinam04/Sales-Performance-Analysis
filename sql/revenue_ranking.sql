SELECT 
    PRODUCT_ID,
    SUM(TOTAL_AMOUNT) AS TOTAL_REVENUE,
    RANK() OVER (ORDER BY SUM(TOTAL_AMOUNT) DESC) AS REVENUE_RANK
FROM SALES_ANALYSIS.SALES
GROUP BY PRODUCT_ID; 